<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<VBox xmlns="http://javafx.com/javafx/21"
      xmlns:fx="http://javafx.com/fxml/1"
      fx:controller="com.serinity.sleepcontrol.controller.SommeilStatsController"
      spacing="16.0"
      stylesheets="@../styles/styles.css"
      style="-fx-background-color: #f5f7fa;"
      minWidth="600" minHeight="500">

    <padding>
        <Insets top="24" right="24" bottom="24" left="24"/>
    </padding>

    <!-- â•â• Titre â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <HBox alignment="CENTER_LEFT" spacing="12.0">
        <Label text="ðŸ“Š Statistiques du Sommeil" styleClass="page-header"/>
        <Region HBox.hgrow="ALWAYS"/>
        <Button text="ðŸ”„ Actualiser" styleClass="btn-secondary" onAction="#actualiser"/>
    </HBox>

    <!-- â•â• KPI Cards â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <HBox spacing="12.0">

        <!-- Nuits suivies -->
        <VBox styleClass="stat-card primary" spacing="5"
              alignment="TOP_LEFT" HBox.hgrow="ALWAYS">
            <Label text="NUITS SUIVIES" styleClass="stat-card-title"/>
            <HBox alignment="CENTER_LEFT" spacing="6.0">
                <Label text="ðŸŒ™" styleClass="stat-card-icon"/>
                <Label fx:id="kpiTotal" text="â€“" styleClass="stat-card-value"/>
            </HBox>
            <Label text="Total nuits enregistrÃ©es"
                   styleClass="stat-card-subtitle"/>
        </VBox>

        <!-- DurÃ©e moyenne -->
        <VBox styleClass="stat-card info" spacing="5"
              alignment="TOP_LEFT" HBox.hgrow="ALWAYS">
            <Label text="DURÃ‰E MOYENNE" styleClass="stat-card-title"/>
            <HBox alignment="CENTER_LEFT" spacing="6.0">
                <Label text="â±" styleClass="stat-card-icon"/>
                <Label fx:id="kpiDuree" text="â€“ h" styleClass="stat-card-value"/>
            </HBox>
            <Label text="Heures par nuit"
                   styleClass="stat-card-subtitle"/>
        </VBox>

        <!-- Score moyen -->
        <VBox styleClass="stat-card success" spacing="5"
              alignment="TOP_LEFT" HBox.hgrow="ALWAYS">
            <Label text="SCORE MOYEN" styleClass="stat-card-title"/>
            <HBox alignment="CENTER_LEFT" spacing="6.0">
                <Label text="â­" styleClass="stat-card-icon"/>
                <Label fx:id="kpiScore" text="â€“ /100" styleClass="stat-card-value"/>
            </HBox>
            <Label text="QualitÃ© globale des nuits"
                   styleClass="stat-card-subtitle"/>
        </VBox>

        <!-- Dette sommeil -->
        <VBox styleClass="stat-card warning" spacing="5"
              alignment="TOP_LEFT" HBox.hgrow="ALWAYS">
            <Label text="DETTE SOMMEIL" styleClass="stat-card-title"/>
            <HBox alignment="CENTER_LEFT" spacing="6.0">
                <Label text="â³" styleClass="stat-card-icon"/>
                <Label fx:id="kpiDette" text="â€“"
                       styleClass="stat-card-value-sm"/>
            </HBox>
            <Label text="Manque accumulÃ© (7j)"
                   styleClass="stat-card-subtitle"/>
        </VBox>

        <!-- EfficacitÃ© -->
        <VBox styleClass="stat-card accent" spacing="5"
              alignment="TOP_LEFT" HBox.hgrow="ALWAYS">
            <Label text="EFFICACITÃ‰" styleClass="stat-card-title"/>
            <HBox alignment="CENTER_LEFT" spacing="6.0">
                <Label text="âš¡" styleClass="stat-card-icon"/>
                <Label fx:id="kpiEfficacite" text="â€“ %"
                       styleClass="stat-card-value"/>
            </HBox>
            <Label text="Temps dormi / temps au lit"
                   styleClass="stat-card-subtitle"/>
        </VBox>

    </HBox>

    <!-- â•â• Bien-Ãªtre & RÃ©silience â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <VBox styleClass="filter-container" spacing="12.0">
        <padding><Insets top="14" right="16" bottom="14" left="16"/></padding>

        <Label text="ðŸ§˜ Bien-Ãªtre &amp; RÃ©silience" styleClass="section-title"/>

        <HBox spacing="24.0">

            <!-- Score bien-Ãªtre -->
            <VBox spacing="6.0" HBox.hgrow="ALWAYS">
                <Label text="Score bien-Ãªtre" styleClass="form-label"/>
                <HBox alignment="CENTER_LEFT" spacing="10.0">
                    <ProgressBar fx:id="barBienEtre" prefWidth="180.0"
                                 prefHeight="10.0"/>
                    <Label fx:id="lblBienEtre" text="â€“"
                           styleClass="stat-bar-label"/>
                </HBox>
            </VBox>

            <!-- RÃ©silience -->
            <VBox spacing="6.0" HBox.hgrow="ALWAYS">
                <Label text="RÃ©silience" styleClass="form-label"/>
                <HBox alignment="CENTER_LEFT" spacing="10.0">
                    <ProgressBar fx:id="barResilience" prefWidth="180.0"
                                 prefHeight="10.0"/>
                    <Label fx:id="lblResilience" text="â€“"
                           styleClass="stat-bar-label"/>
                </HBox>
            </VBox>

            <!-- DurÃ©e optimale -->
            <VBox spacing="6.0" HBox.hgrow="ALWAYS">
                <Label text="DurÃ©e optimale" styleClass="form-label"/>
                <HBox alignment="CENTER_LEFT" spacing="10.0">
                    <ProgressBar fx:id="barOptimale" prefWidth="180.0"
                                 prefHeight="10.0"/>
                    <Label fx:id="lblOptimale" text="â€“%"
                           styleClass="stat-bar-label"/>
                </HBox>
            </VBox>

        </HBox>
    </VBox>

    <!-- â•â• RÃ©partition & Tendances â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <HBox spacing="14.0" VBox.vgrow="ALWAYS">

        <!-- RÃ©partition par qualitÃ© -->
        <VBox styleClass="filter-container" spacing="10.0"
              HBox.hgrow="ALWAYS">
            <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
            <Label text="ðŸ“ˆ RÃ©partition qualitÃ©"
                   styleClass="section-title"/>
            <VBox fx:id="qualiteContainer" spacing="8.0"/>
        </VBox>

        <!-- RÃ©partition humeur -->
        <VBox styleClass="filter-container" spacing="10.0"
              HBox.hgrow="ALWAYS">
            <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
            <Label text="ðŸ˜´ Humeur au rÃ©veil"
                   styleClass="section-title"/>
            <VBox fx:id="humeurContainer" spacing="8.0"/>
        </VBox>

        <!-- Tendances -->
        <VBox styleClass="filter-container" spacing="10.0"
              HBox.hgrow="ALWAYS">
            <padding><Insets top="14" right="14" bottom="14" left="14"/></padding>
            <Label text="ðŸ”® Tendances (30j)"
                   styleClass="section-title"/>
            <VBox fx:id="tendancesContainer" spacing="8.0"/>
        </VBox>

    </HBox>

    <!-- â•â• Insights â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
    <VBox styleClass="filter-container" spacing="10.0">
        <padding><Insets top="14" right="16" bottom="14" left="16"/></padding>

        <Label text="ðŸ’¡ Insights personnalisÃ©s"
               styleClass="section-title"/>

        <!-- FlowPane pour les chips qui s'adaptent Ã  la largeur -->
        <FlowPane fx:id="insightsContainer"
                  hgap="8.0" vgap="8.0"
                  prefWrapLength="700.0"/>

    </VBox>

</VBox>
