<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.ListView?>
<?import javafx.scene.image.Image?>
<?import javafx.scene.image.ImageView?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Region?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>

<BorderPane styleClass="mood-root"
  xmlns="http://javafx.com/javafx/21"
  xmlns:fx="http://javafx.com/fxml/1"
  fx:controller="com.serinity.accesscontrol.controller.MoodHomeController">

  <!-- ===== HEADER ===== -->
  <top>
    <HBox alignment="CENTER_LEFT" spacing="10" styleClass="page-header">
      <padding>
        <Insets bottom="10" left="16" right="16" top="16" />
      </padding>

      <Label styleClass="page-title" text="%mood.title" />
      <Region HBox.hgrow="ALWAYS" />
      <Label styleClass="page-hint" text="%mood.hint" />
    </HBox>
  </top>

  <!-- ===== CONTENT ===== -->
  <center>
    <StackPane fx:id="moodHost" styleClass="mood-host">

      <!-- Main page content -->
      <VBox alignment="TOP_CENTER"
        spacing="16"
        fillWidth="true"
        maxWidth="Infinity"
        maxHeight="Infinity">
        <padding>
          <Insets bottom="26" left="26" right="26" top="26" />
        </padding>
        <!-- Right-side: hint pill with icon BELOW it -->
        <VBox alignment="CENTER_RIGHT" spacing="6">

          <Button styleClass="icon-btn"
            onAction="#onOpenInsights"
            accessibleText="%mood.insights.title">
            <graphic>
              <ImageView id="insights_icon"
                fitWidth="50"
                fitHeight="50"
                preserveRatio="true"
                pickOnBounds="true"
                styleClass="clickable-icon" />
            </graphic>
          </Button>
        </VBox>
        <Region prefHeight="8" minHeight="8" />

        <!-- Cards row -->
        <HBox alignment="CENTER"
          spacing="18"
          maxWidth="Infinity"
          maxHeight="Infinity"
          VBox.vgrow="ALWAYS"
          styleClass="mood-hub-row">

          <!-- Log -->
          <StackPane fx:id="cardLogMood"
            prefWidth="320"
            maxWidth="Infinity"
            maxHeight="Infinity"
            HBox.hgrow="ALWAYS"
            styleClass="mood-card">
            <VBox alignment="CENTER" spacing="10">
              <ImageView fx:id="mood_log"
                fitHeight="56.0"
                fitWidth="59.0"
                pickOnBounds="true"
                preserveRatio="true">
                <image>
                  <Image url="@../../assets/icons/mood_log.png" />
                </image>
                <VBox.margin>
                  <Insets bottom="10.0" />
                </VBox.margin>
              </ImageView>

              <Label styleClass="mood-card-title" text="%mood.card.log.title" />
              <Label styleClass="mood-card-sub" text="%mood.card.log.sub" />
            </VBox>
          </StackPane>

          <!-- History -->
          <StackPane fx:id="cardMoodHistory"
            prefWidth="320"
            maxWidth="Infinity"
            maxHeight="Infinity"
            HBox.hgrow="ALWAYS"
            styleClass="mood-card">
            <VBox alignment="CENTER" spacing="10">
              <ImageView fx:id="mood_history"
                fitHeight="56.0"
                fitWidth="59.0"
                pickOnBounds="true"
                preserveRatio="true">
                <image>
                  <Image url="@../../assets/icons/mood_history.png" />
                </image>
                <VBox.margin>
                  <Insets bottom="10.0" />
                </VBox.margin>
              </ImageView>

              <Label styleClass="mood-card-title" text="%mood.card.history.title" />
              <Label styleClass="mood-card-sub" text="%mood.card.history.sub" />
            </VBox>
          </StackPane>

          <!-- Journal -->
          <StackPane fx:id="cardJournal"
            prefWidth="320"
            maxWidth="Infinity"
            maxHeight="Infinity"
            HBox.hgrow="ALWAYS"
            styleClass="mood-card">
            <VBox alignment="CENTER" spacing="10">
              <ImageView fx:id="mood_journal"
                fitHeight="56.0"
                fitWidth="59.0"
                pickOnBounds="true"
                preserveRatio="true">
                <image>
                  <Image url="@../../assets/icons/mood_journal.png" />
                </image>
                <VBox.margin>
                  <Insets bottom="10.0" />
                </VBox.margin>
              </ImageView>

              <Label styleClass="mood-card-title" text="%mood.card.journal.title" />
              <Label styleClass="mood-card-sub" text="%mood.card.journal.sub" />
            </VBox>
          </StackPane>

        </HBox>

        <Region prefHeight="20" minHeight="20" />

        <!-- ===== DAILY ZEN ===== -->
        <HBox spacing="14"
          maxWidth="Infinity"
          styleClass="boost-card">
          <VBox spacing="6" HBox.hgrow="ALWAYS">
            <Label styleClass="boost-title" text="%mood.zen.title" />
            <Label fx:id="zenQuoteText"
              styleClass="boost-quote"
              text="%mood.zen.loading"
              wrapText="true" />
            <Label fx:id="zenQuoteAuthor"
              styleClass="boost-author"
              text="" />
          </VBox>

          <Button fx:id="btnNewQuote"
            styleClass="boost-refresh"
            text="%mood.zen.refresh" />
        </HBox>
      </VBox>

      <!--INSIGHTS -->

      <!-- Overlay -->
      <StackPane fx:id="insightsOverlay"
        visible="false"
        managed="false"
        styleClass="sheet-overlay"
        StackPane.alignment="CENTER"
        onMouseClicked="#onCloseInsights" />

      <!-- Right-side sheet (20% wider: 520 -> 624) -->
      <VBox fx:id="insightsSheet"
        visible="false"
        managed="false"
        prefWidth="624"
        maxWidth="624"
        styleClass="sheet"
        StackPane.alignment="CENTER_RIGHT">

        <HBox alignment="CENTER_LEFT" spacing="10" styleClass="sheet-header">
          <Label text="%mood.insights.title" styleClass="sheet-title" />
          <Region HBox.hgrow="ALWAYS" />
          <Button text="âœ•"
            styleClass="sheet-close"
            onAction="#onCloseInsights" />
        </HBox>

        <Label fx:id="insightsStatusLabel"
          text="%mood.insights.loading"
          styleClass="sheet-subtitle" />

        <HBox spacing="14.0" styleClass="insights-grid" VBox.vgrow="ALWAYS">
          <!-- Influences -->
          <VBox spacing="8.0" HBox.hgrow="ALWAYS" styleClass="insight-panel">
            <Label text="%mood.insights.influences" styleClass="insight-col-title" />

            <!-- Header row -->
            <HBox spacing="10" styleClass="insight-header-row">
              <Label text="%insight.col.name" styleClass="insight-h-name" />
              <Region HBox.hgrow="ALWAYS" />
              <Label text="%insight.col.count" styleClass="insight-h-num" />
              <Label text="%insight.col.avg" styleClass="insight-h-num" />
              <Label text="%insight.col.low" styleClass="insight-h-num" />
            </HBox>

            <ListView fx:id="influenceImpactList"
              prefHeight="260.0"
              VBox.vgrow="ALWAYS"
              styleClass="insight-list" />
          </VBox>

          <!-- Emotions -->
          <VBox spacing="8.0" HBox.hgrow="ALWAYS" styleClass="insight-panel">
            <Label text="%mood.insights.emotions" styleClass="insight-col-title" />

            <!-- Header row -->
            <HBox spacing="10" styleClass="insight-header-row">
              <Label text="%insight.col.name" styleClass="insight-h-name" />
              <Region HBox.hgrow="ALWAYS" />
              <Label text="%insight.col.count" styleClass="insight-h-num" />
              <Label text="%insight.col.avg" styleClass="insight-h-num" />
              <Label text="%insight.col.low" styleClass="insight-h-num" />
            </HBox>

            <ListView fx:id="emotionImpactList"
              prefHeight="260.0"
              VBox.vgrow="ALWAYS"
              styleClass="insight-list" />
          </VBox>
        </HBox>

        <HBox alignment="CENTER_RIGHT" spacing="10" styleClass="sheet-footer">
          <Button text="%btn.refresh"
            onAction="#onRefreshInsights"
            styleClass="btn-pill" />
        </HBox>

      </VBox>

    </StackPane>
  </center>

</BorderPane>
