@startuml
skinparam classAttributeIconSize 0
skinparam packageStyle rectangle

' =======================
' User Management Package
' =======================
package "User Management" {

  class User {
    +id: UUID
    +email: String
    +password: String
    +status: AccountStatus
    +createdAt: DateTime
  }

  class Patient {
    +medicalHistory: Text
    +emergencyContact: String
    +therapyGoals: Text
  }

  class Therapist {
    +licenseNumber: String
    +specialization: String
    +yearsOfExperience: int
  }
  
  class Admin {
    +department: String
    +accessLevel: int
  }

  User <|.. Patient
  User <|.. Therapist
  User <|.. Admin

  class Profile {
    +firstName: String
    +lastName: String
    +dateOfBirth: Date
    +gender: String
  }

  class Role {
    +id: Long
    +name: RoleType
  }

  class Permission {
    +id: Long
    +code: String
  }

  class AuthSession {
    +id: UUID
    +loginTime: DateTime
    +logoutTime: DateTime
    +ipAddress: String
  }

  class AuditLog {
    +id: Long
    +action: String
    +timestamp: DateTime
  }

  User "1" -- "1" Profile
  User "1" -- "*" AuthSession
  User "1" -- "*" AuditLog
  User "*" -- "*" Role
  Role "*" -- "*" Permission
}

' =======================
' Mood & Journal Package
' =======================
package "Mood & Journal" {

  class Mood {
    +id: Long
    +emotion: String
    +intensity: int
    +date: Date
  }

  class Journal {
    +id: Long
    +content: Text
    +createdAt: DateTime
  }

  class Question {
    +id: Long
    +label: String
  }

  class Choice {
    +id: Long
    +value: String
  }

  User "1" -- "*" Mood
  User "1" -- "*" Journal
  Question "1" -- "*" Choice
}

' =======================
' Sleep Management Package
' =======================
package "Sleep Management" {

  class Cycle {
    +id: Long
    +startTime: DateTime
    +endTime: DateTime
    +quality: int
  }

  class Dream {
    +id: Long
    +emotion: String
    +intensity: int
    +description: Text
  }

  User "1" -- "*" Cycle
  Cycle "1" -- "*" Dream
}

' =======================
' Exercises & Resources Package
' =======================
package "Exercises & Resources" {

  class Exercise {
    +id: Long
    +title: String
    +level: String
    +duration: int
  }

  class Resource {
    +id: Long
    +title: String
    +type: ResourceType
    +url: String
  }

  class ExerciseSession {
    +id: Long
    +status: String
    +feedback: Text
  }

  class Favorite {
    +id: Long
  }

  Exercise "1" -- "*" ExerciseSession
  User "1" -- "*" ExerciseSession
  User "1" -- "*" Favorite
  Favorite "*" -- "1" Exercise
  Favorite "*" -- "1" Resource
}

' =======================
' Appointment & Consultation Package
' =======================
package "Appointments & Consultations" {

  class Appointment {
    +id: Long
    +dateTime: DateTime
    +status: AppointmentStatus
  }

  class Consultation {
    +id: Long
    +startTime: DateTime
    +endTime: DateTime
    +summary: Text
  }

  class Availability {
    +id: Long
    +startTime: DateTime
    +endTime: DateTime
  }

  Patient "1" -- "*" Appointment : books
  Therapist "1" -- "*" Appointment : attends
  Appointment "1" -- "1" Consultation
  Therapist "1" -- "*" Availability
}

' =======================
' Community Package
' =======================
package "Community / Forum" {

  class Post {
    +id: Long
    +content: Text
    +createdAt: DateTime
  }

  class Comment {
    +id: Long
    +content: Text
    +createdAt: DateTime
  }

  User "1" -- "*" Post
  Post "1" -- "*" Comment
  User "1" -- "*" Comment
}

' =======================
' AI Services (Logical Layer)
' =======================
package "AI Services" {

  class EmotionAnalyzer {
    +analyzeJournal()
    +detectMood()
  }

  class RecommendationEngine {
    +recommendExercises()
    +recommendAppointments()
  }

  class SessionSummarizer {
    +summarize()
  }
}

Journal ..> EmotionAnalyzer : uses
Mood ..> EmotionAnalyzer : uses
User ..> RecommendationEngine : uses
Consultation ..> SessionSummarizer : uses

@enduml
